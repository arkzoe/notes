- 把对数据库的读和写操作分开,以对应不同的数据库服务器。主数据库提供写操作,从数据库提供读操作,这样能有效地减轻单台数据库的压力
- 通过MyCat即可轻易实现上述功能,不仅可以支持MySQL,也可以支持Oracle和SQL Server
# 一主一从
- 主从复制基于二进制日志
## 读写分离
- MyCat控制后台数据库的读写分离和负载均衡由schema.xml文件datahost标签的balance属性控制
- balance值

| 参数值 | 含义                                                                              |
| ------ | --------------------------------------------------------------------------------- |
| 0      | 不开启读写分离机制,所有读操作都发送到当前可用writeHost上                          |
| 1      | 全部的readHost与备用的writeHost都参与select语句的负载均衡(主要针对于双主双从模式) |
| 2      | 所有的读写操作都随机在writeHost,readHost上分发                                    |
| 3      | 所有的读请求随机分发到writeHost对应的readHost上执行,writeHost不负担读压力         |
# 双主双从
- 一个主机Master1用于处理所有写请求,它的从机Slave1和另一台主机Master2还有它的从机Slave2负责所有读请求。当Master1主机宕机后,Master2主机负责写请求,Master1、Master2互为备机，互相复制
- 5台主机
- 主库
1. 修改配置文件
2. 重启
3. 两台主机创建账户授权
	- 日志查看二级制日志坐标
- 从库
1. 修改配置文件
2. 重启
3. 两台从库配置关联的主库
	- 启动从库主从复制，查看从库状态
- 主库互相复制
	- 启动从库主从复制，查看从库状态
## 读写分离
- MyCat控制后台数据库的读写分离和负载均衡由schema.xml文件datahost标签的balance属性控制，通过writeType和switchType完成失败自动切换
- balance="1"
	- 代表 全部的readHost与stand by writeHost参与select语句的负载均衡,简单的说,当双主双从模式(M1->S1,M2->S2,并且M1与M2互为主备),正常情况下,M2,51,S2都参与select语句的负载均衡：
- writeType
	- 0:写操作都转发到第1台writeHost,writeHost1挂了,会切换到writeHost2上：
	- 1:所有的写操作都随机地发送到配置的writeHost上：
- switchType
	- -1:不自动切换
	- 1:自动切换